# OperatingSystem Note

## 1장. Introduction

운영체제는 컴퓨터 사용자와 컴퓨터 하드웨어 사이에서 중개자(intermediary) 역할

사용자가 프로그램을 편리하고 효율적으로 수행할 수 있는 환경을 제공하는 데 있다.

컴퓨터 하드웨어를 관리하는 소프트웨어, 운영체제를 자원 할당자

응용 프로그램을 위한 기반을 제공

하드웨어, 운영체제, 응용 프로그램 및 사용자로 구분

- 하드웨어: 하드웨어는 중앙 처리 장치(CPU), 메모리 및 입출력(I/O) 장치로 구성되어, 기본 계산용 자원을 제공한다
- 응용 프로그램: 응용 프로그램이란 워드 프로세서, 스프레드시트, 컴파일러, 웹 브라우저 등을 말하며 사용자의 계산 문제를 해결하기 위해 이들 자원이 어떻게 사용될지를 정의한다.
- 운영체제: 위 구성도에서 운영체제는 다양한 사용자를 위해 다양한 응용 프로그램 간의 하드웨어 사용을 제어하고 조정하는 역할을 한다.
- 사용자: 컴퓨터에 대한 사용자의 관점은 사용되는 인터페이스에 따라 달라진다.

 
인터럽트: 하드웨어는 어느 순간이든 시스템 버스를 통해 CPU에 신호를 보내 인터럽트를 발생시킬 수 있다.

인터럽트는 다른 많은 목적으로도 사용되며 운영체제와 하드웨어의 상호 작용 방식의 핵심 부분이다.
 
CPU가 인터럽트 되면,

- CPU는 하던 일을 중단하고 즉시 고정된 위치로 실행을 옮긴다. 이러한 고정된 위치는 일반적으로 인터럽트를 위한 서비스 루틴이 위치한 시작 주소를 가지고 있다.

- 그리고 인터럽트 서비스 루틴이 실행된다.

- 인터럽트 서비스 루틴의 실행이 완료되면, CPU는 인터럽트 되었던 연산을 재개한다.

인터럽트는 최신 운영체제에서 비동기 이벤트를 처리하기 위해 사용된다.

저장장치 구조: CPU는 메모리에서만 명령을 적재할 수 있으므로 실행하려면 프로그램을 먼저 메모리에 적재해야 한다.

범용 컴퓨터는 프로그램 대부분을 메인 메모리(RAM)라는 재기록 가능한 메모리에서 가져온다.

컴퓨터는 다른 형태의 메모리도 사용하는데, 예를 들어 부트스트랩 프로그램은 운영체제를 적재하고 있으며 컴퓨터 전원을 켤 때 가장 먼저 실행되는 프로그램이다. 이때 RAM은 휘발성(전원이 꺼질 때 내용이 손실되는) 메모리이므로 부트스트랩 프로그램을 유지하는 용도로 사용할 수 없다.

대신 컴퓨터는 전기적으로 소거 가능한 프로그램 가능 읽기 전용 메모리(EEPROM) 및 기타 형태의 펌웨어를 사용한다.

CPU - 명령을 실행하는 하드웨어  
프로세서(processor) - 하나 이상의 CPU를 포함하는 물리적 칩  
코어(core) - CPU의 기본 계산 단위  
다중 코어(multicore) - 동일한 CPU에 여러 컴퓨팅 코어를 포함함  
다중 처리기(multiprocessor) - 여러 프로세서를 포함함  

멀티프로그래밍과 멀티태스킹

운영체제의 가장 중요한 측면 중 하나는 하나의 프로그램은 항상 CPU나 I/O 장치를 바쁘게 유지할 수 없으므로 여러 프로그램을 실행할 수 있다는 것이다. (한 프로그램이 모든 장치를 사용해 동작하지 않는다는 의미)

또한 사용자는 일반적으로 한 번에 둘 이상의 프로그램을 실행하려 한다.

메인 메모리의 특징

메인 메모리는 CPU와 입출력 장치에 의해 공유되는, 빠른 접근이 가능한 데이터의 저장소이다.
일반적으로 CPU가 직접 주소를 지정할 수 있고, 직접 접근할 수 있는 유일한 대량 메모리이다




## 9장.Virtual Memory

버츄얼 메모리, 가상 메모리는 물리적 메모리의 한계를 극복하기 위해 나온 개념이다.

프로세스를 실행할 때 실행에 필요한 일부분만 메모리에 로드하고 나머지는 디스크에 두는 것이다.

현재 필요한 page만 메모리에 올리는 것을 Demand Paging이라고 한다. 

### Demand Paging

Demand paging은 실제로 필요할 때 page를 메모리에 올리는 것이다. 

이를 통해 CPU 이용률과 처리율이 높아지고, 더 많은 사용자를 수용할 수 있다.  

## 10장. File System

파일은 논리적 저장단위로 관련된 정보 자료들의 집합에 이름을 붙인 것이다.

컴퓨터 시스템의 편리한 사용을 위해 정보 저장의 일괄된 논리적 관점을 제공한다.  

일반적으로 레코드(Record) 혹은 블록(Block) 단위로 비휘발성 보조기억장치에 저장된다.  

파일 속성(File attribute) 또는 파일의 메타데이터(metadata)는 파일을 관리하기 위한 각종 정보들이다. 파일 자체의 내용은 아니다. 

파일 이름, 유형, 저장된 위치, 파일 사이즈, 접근 권한, 소유자, 시간(생성/변경/사용) 등 파일에 대한 전반적인 정보를 말한다. 

파일 시스템(File System)은 운영체제와 모든 데이터, 프로그램의 저장과 접근을 위한 기법을 제공한다.

시스템 내의 모든 파일에 관한 정보를 제공하는 계층적 디렉터리 구조이고, 파일 및 파일의 메타데이터, 디렉터리 정보 등을 관리한다.

파티션(Partition)은 연속된 저장 공간을 하나 이상의 연속되고 독립적인 영역으로 나누어 사용할 수 있도록 정의한 규약이다. 하나의 물리적 디스크 안에 여러 파티션을 두는 게 일반적이지만, 여러 물리적 디스크를 하나의 파티션으로 구성하기도 한다. 

*다시 정리*
## 13장. File System Interface

- 파일은 운영체제의 의하여 정의되고 구현되는 추상적인 자료형이다.
- 파일은 논리 레코드의 연속으로서, 바이트, 행 또는 좀 더 복잡한 자료 항목들이다.
- 운영체제는 다양한 레코드형을 사용자에게 제공하거나 아니면 사용자가 프로그램상으로 정의하도록 해준다.
- 운영체제의 가장 중요한 문제는 논리적인 파일을 실제 저장장치(하드)에 어떻게 매핑시키는 것인지
  - 보통 물리 레코드 크기는 논리 레코드와 일치하지 않기 때문에, 논리 레코드를 물리 레코드에 연관시켜야한다.
  - 이 작업은 운영체제에 의하여 제공되거나 사용자의 응용 프로그램에서 할 수 있다.
- 파일 시스템 내에서 파일을 구조화하는 디렉터리를 만드는 것이 유용하다.
  - 다중 사용자 시스템에서 1단계 디렉터리는 모든 파일이 고유의 이름을 가져야 하므로 파일 명칭 부여 문제를 유발한다.
  - 2단게 디렉터리는 각 사용자에 대하여 독자적인 디렉터리를 할당함으로써 이 문제를 해결한다.
  - 디렉터리는 이름으로 파일을 기록하고, 디스크 상에서의 파일의 위치, 길이, 형태, 소유자, 생성시간, 마지막 사용 시간등 과 같은 정보를 포함한다.
- 파일 또한 디스크의 공간을 회수하기 위해 가비지 컬랙션이 필요
  - 2단계 디렉터리를 일반화하여 확장하면 트리 구조 디렉터리가 되는데 사용자만의 서브디렉터리를 구성할 수 있게 해준다.
  - 일반적인 그래프 디렉터리는 디렉터리와 파일의 공유에 완전한 융통성을 주는 대신 사용되지 않는 디스크 공간을 회수하기 위해 가비지 컬랙션을 필요로 한다.

### Contiguous Allocation (연속 할당)

하나의 파일이 디스크 상에 연속해서 저장되는 방식

- 단점
  - 외부 조각이 발생한다.
  - 파일의 크기를 키우는 데 제약이 있다. 파일을 수정하면서 파일의 크기가 커질 수 있는데, 그것에 제약이 있다는 것이다. 그래서 미리 여유 공간을 할당할 수는 있지만, 이 경우 내부 조각이 발생할 수 있다.

- 장점
  - 빠른 입출력이 가능하다.
  - 한번의 seek/rotation으로 많은 바이트를 전송할 수 있다.
  - realtime file용으로, 또는 이미 run 중이던 프로세스의 swapping용으로 사용 가능하다.
  - 직접 접근(임의 접근)이 가능하다.

### Linked Allocation (연결 할당)

파일의 데이터를 디스크에 연속적으로 배치하는 대신, 빈 위치 아무데나 들어갈 수 있게 배치하는 방식

- 장점
  - 외부 조각이 발생하지 않는다.
- 단점
  - 직접 접근(임의 접근)이 불가능하다.
  - reliability 문제
  - 하나의 sector가 bad sector가 되어 pointer가 유실되면 이후 부분을 모두 잃어버리게 된다.
  - 포인터를 위한 공간이 block의 일부가 되어 공간 효율성을 떨어뜨린다.
  - 디스크에서 하나의 sector는 512byte를 차지하는데, 포인터가 4byte를 차지하므로 비효율적이다.
- 변형
  - File-allocation table (FAT) 파일 시스템
  - 포인터를 별도의 위치에 보관하여 reliability와 공간 효율성의 문제를 해결한다. (아래에서 자세히 다룸)

### Indexed Allocation (인덱스 할당)

블록 하나에 위치 정보를 저장하는데, 이 블록을 인덱스 블록이라고 한다. 디렉토리는 파일의 위치 정보 대신 인덱스 블록 값을 저장한다.

- 장점
  - 외부 조각이 발생하지 않는다.
  - 직접 접근(임의 접근)이 가능하다.
  - (연속 할당 / 연결 할당의 단점을 모두 극복)
- 단점
  - 작은 파일인 경우 공간이 낭비된다. (실제로 많은 파일들의 크기가 작다.)
  - 너무 큰 파일인 경우 하나의 블록으로 인덱스를 모두 저장할 수 없다.
  - 해결 방안
    - linked scheme
      - 인덱스 블록의 마지막 위치가 또 다른 인덱스 블록을 가리키게 한다.
    - multi-level index
      - 인덱스 블록 내의 값들이 각각 인덱스 블록을 가리킨다.
      - (2단계 페이징 테이블과 유사)

